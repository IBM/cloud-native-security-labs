
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="IBM Developer">
      
      
        <link rel="canonical" href="https://ibm.github.io/ddc-cloud-native-security-labs/lab-01/">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>Lab 1. Kubernetes Networking - Cloud Native Security Labs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700%7CIBM+Plex+Mono&display=fallback">
        <style>body,input{font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"IBM Plex Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-01-kubernetes-networking-using-service-types-ingress-and-network-policies-to-control-application-access" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://ibm.github.io/ddc-cloud-native-security-labs" title="Cloud Native Security Labs" class="md-header-nav__button md-logo" aria-label="Cloud Native Security Labs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Cloud Native Security Labs
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Lab 1. Kubernetes Networking
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ibm/ddc-cloud-native-security-labs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ddc-cloud-native-security-labs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        Welcome
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../lab-00/" class="md-tabs__link md-tabs__link--active">
        Workshop
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../resources/" class="md-tabs__link">
        References
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ibm.github.io/ddc-cloud-native-security-labs" title="Cloud Native Security Labs" class="md-nav__button md-logo" aria-label="Cloud Native Security Labs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Cloud Native Security Labs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ibm/ddc-cloud-native-security-labs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ddc-cloud-native-security-labs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
    
    <label class="md-nav__link" for="nav-1">
      Welcome
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Welcome" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Welcome
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      About the workshop
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../lab-00/NEWACCOUNT/" class="md-nav__link">
      Create an IBM Cloud account
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Workshop
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Workshop" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Workshop
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../lab-00/" class="md-nav__link">
      Workshop Setup
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Lab 1. Kubernetes Networking
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Lab 1. Kubernetes Networking
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#00-access-your-cluster" class="md-nav__link">
    00. Access Your Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-setup-mongodb" class="md-nav__link">
    01. Setup MongoDB
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-deploy-a-helloworld-app" class="md-nav__link">
    02. Deploy a HelloWorld App
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#servicetypes" class="md-nav__link">
    ServiceTypes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03-clusterip" class="md-nav__link">
    03. ClusterIP
  </a>
  
    <nav class="md-nav" aria-label="03. ClusterIP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-service-to-helloworld" class="md-nav__link">
    Add a Service to helloworld
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-nodeport" class="md-nav__link">
    04. NodePort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#05-loadbalancer" class="md-nav__link">
    05. Loadbalancer
  </a>
  
    <nav class="md-nav" aria-label="05. Loadbalancer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-balancer-on-iks" class="md-nav__link">
    Load Balancer on IKS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-balancing-methods" class="md-nav__link">
    Load Balancing Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-network-load-balancer-v10" class="md-nav__link">
    Create a Network Load Balancer v1.0
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#06-ingress" class="md-nav__link">
    06. Ingress
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changes-to-helloworld-for-ingress" class="md-nav__link">
    Changes to HelloWorld for Ingress
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#06-network-policy" class="md-nav__link">
    06. Network Policy
  </a>
  
    <nav class="md-nav" aria-label="06. Network Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-policy" class="md-nav__link">
    Network Policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete-resources" class="md-nav__link">
    Delete Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../lab-02/" class="md-nav__link">
      Lab 2. Adding Secure Storage
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../lab-03/" class="md-nav__link">
      Lab 3. Source-to-Image (S2I)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      References
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="References" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../resources/" class="md-nav__link">
      Additional resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#00-access-your-cluster" class="md-nav__link">
    00. Access Your Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-setup-mongodb" class="md-nav__link">
    01. Setup MongoDB
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-deploy-a-helloworld-app" class="md-nav__link">
    02. Deploy a HelloWorld App
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#servicetypes" class="md-nav__link">
    ServiceTypes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03-clusterip" class="md-nav__link">
    03. ClusterIP
  </a>
  
    <nav class="md-nav" aria-label="03. ClusterIP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-service-to-helloworld" class="md-nav__link">
    Add a Service to helloworld
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-nodeport" class="md-nav__link">
    04. NodePort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#05-loadbalancer" class="md-nav__link">
    05. Loadbalancer
  </a>
  
    <nav class="md-nav" aria-label="05. Loadbalancer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-balancer-on-iks" class="md-nav__link">
    Load Balancer on IKS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-balancing-methods" class="md-nav__link">
    Load Balancing Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-network-load-balancer-v10" class="md-nav__link">
    Create a Network Load Balancer v1.0
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#06-ingress" class="md-nav__link">
    06. Ingress
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changes-to-helloworld-for-ingress" class="md-nav__link">
    Changes to HelloWorld for Ingress
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#06-network-policy" class="md-nav__link">
    06. Network Policy
  </a>
  
    <nav class="md-nav" aria-label="06. Network Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-policy" class="md-nav__link">
    Network Policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delete-resources" class="md-nav__link">
    Delete Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ibm/ddc-cloud-native-security-labs/edit/master/docs/lab-01/README.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="lab-01-kubernetes-networking-using-service-types-ingress-and-network-policies-to-control-application-access">Lab 01 - Kubernetes Networking, using Service Types, Ingress and Network Policies to Control Application Access<a class="headerlink" href="#lab-01-kubernetes-networking-using-service-types-ingress-and-network-policies-to-control-application-access" title="Permanent link">&para;</a></h1>
<p>Self: <a href="https://github.com/remkohdev/kubernetes-networking">https://github.com/remkohdev/kubernetes-networking</a></p>
<p>In this lab we will use several methods to control access to applications on a Kubernetes cluster. We will go through Kubernetes Networking principles and apply different types of Service resources: ClusterIP, NodePort and LoadBalancer. We will also implement an Ingress resource and a Network Policy, while we briefly will talk about Calico policies as well.</p>
<p>You need an IBM account to follow the lab. See the <a href="../lab-00/">Account Setup and Cluster Access</a></p>
<p>In the first steps, you access your cluster, deploy a MongoDB instance and a HelloWorld application, which will take about 15 minutes.</p>
<p>During the remainder of the lab, you will create different Service types, an Ingress and a Network Policy.</p>
<h2 id="00-access-your-cluster">00. Access Your Cluster<a class="headerlink" href="#00-access-your-cluster" title="Permanent link">&para;</a></h2>
<p>Follow the instructions at <a href="../lab-00/">Account Setup and Cluster Access</a> to claim a pre-created cluster. Go to the <code>Access</code> page to find the login instructions.</p>
<p>Access your <code>Cloud Shell</code> at <a href="https://shell.cloud.ibm.com">https://shell.cloud.ibm.com</a> and login to your remote cluster.</p>
<p>Set a CLUSTERNAME environment variable to the name of your cluster.</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">CLUSTERNAME</span><span class="o">=</span>remkohdev-iks116-2n-cluster-labs
</code></pre></div>
<p>Login and download the cluster configuration,</p>
<div class="highlight"><pre><span></span><code>ibmcloud login
ibmcloud ks cluster config --cluster <span class="nv">$CLUSTERNAME</span>
</code></pre></div>
<h2 id="01-setup-mongodb">01. Setup MongoDB<a class="headerlink" href="#01-setup-mongodb" title="Permanent link">&para;</a></h2>
<p>We will begin by deploying a MongoDB database and a HelloWorld application that stores messages into the MongoDB.</p>
<p>I will use Helm to deploy and configure a Bitnami/MongoDB chart. Go to <a href="MONGODB/">Deploy MongoDB</a> to setup MongoDB for our HelloWorld app.</p>
<h2 id="02-deploy-a-helloworld-app">02. Deploy a HelloWorld App<a class="headerlink" href="#02-deploy-a-helloworld-app" title="Permanent link">&para;</a></h2>
<p>Now, you have a MongoDB installed, follow the instructions to <a href="JAVAAPP/">Deploy a HelloWorld App with ClusterIP</a>.</p>
<h2 id="services">Services<a class="headerlink" href="#services" title="Permanent link">&para;</a></h2>
<p>Now we can start with the actual lab on Kubernetes Networking.</p>
<p>When we created the Java Spring Boot App called <code>HelloWorld</code>, we created a Deployment. The deployment created also a ReplicaSet with 1 replica of the pods. Because we did not create a Service for the <code>helloworld</code> containers running in pods, they cannot yet be accessed.</p>
<p>When a Pod is deployed to a worker node, it is assigned a <code>private IP address</code> in the 172.30.0.0/16 range. Worker nodes and pods can securely communicate on the private network by using private IP addresses.</p>
<p>However, because Kubernetes creates and destroys Pods dynamically, the location of the Pods, and thus the private IP addresses, change.</p>
<p>With a <code>Service</code> object, you can use built-in Kubernetes <code>service discovery</code> to expose Pods. A Service defines a set of Pods and a policy to access those Pods. Kubernetes assigns a single DNS name for a set of Pods and can load balance requests across Pods. When you create a Service, a set of pods and <code>EndPoints</code> are created to manage access to the pods.</p>
<p>The Endpoints object in Kubernetes is the list of IP and port addresses to the Pods and are created automatically when a Service is created and are configured with the pods matching the selector defined in the Service. A Service can be configured without a selector, in that case Kubernetes does not create an associated Endpoints object.</p>
<p>Let's look at the declaration of the <code>service.yaml</code>,</p>
<div class="highlight"><pre><span></span><code>$ cat service.yaml

apiVersion: v1
kind: Service
metadata:
  name: helloworld
  labels:
    app: helloworld
spec:
  ports:
  - port: <span class="m">8080</span>
    targetPort: http-server
  selector:
    app: helloworld
</code></pre></div>
<p>The <code>spec</code> defines a few important attributes, especially <code>selector</code> and <code>ports</code>. The set of Pods that a Service targets, is determined by the selector using labels. When a Service has no selector, the corresponding <code>Endpoints</code> object is not created automatically. This can be useful in cases where you want to define an Endpoint manually, for instance in the case of an external database instance.</p>
<p>The Service maps the incoming <code>port</code> to a <code>targetPort</code> of the Deployment. By default the <code>targetPort</code> is set to the same value as the incoming <code>port</code> field. A port definition in Pods can also be given a name, and you can reference these names in the <code>targetPort</code> attribute of the Service instead of using a port number. In the Service example of <code>helloworld</code>, the <code>deployment.yaml</code> file should then have the corresponding port defined that the Service references by name,</p>
<div class="highlight"><pre><span></span><code>$ cat deployment.yaml

ports:
- name: http-server
  containerPort: <span class="m">8080</span>
</code></pre></div>
<h2 id="servicetypes">ServiceTypes<a class="headerlink" href="#servicetypes" title="Permanent link">&para;</a></h2>
<p>Before you create a Service for the <code>helloworld</code> application, let's first understand what types of services exist. Kubernetes <code>ServiceTypes</code> allow you to specify what kind of Service you want.</p>
<p>The default type is <code>ClusterIP</code>. To expose a Service onto an external IP address, you have to create a ServiceType other than ClusterIP.</p>
<p>ServiceType values and their behaviors are:</p>
<ul>
<li><strong>ClusterIP</strong>: Exposes the Service on a cluster-internal IP. This is the default ServiceType.</li>
<li><strong>NodePort</strong>: Exposes the Service on each Node’s IP at a static port (the NodePort). A ClusterIP Service, to which the NodePort Service routes, is also automatically created. You’ll be able to contact the NodePort Service, from outside the cluster, by requesting <code>&lt;Node-Public-IP&gt;:&lt;NodePort&gt;</code>.</li>
<li><strong>LoadBalancer</strong>: Exposes the Service externally using a cloud provider’s load balancer. The NodePort and ClusterIP Services, to which the external load balancer routes, are also automatically created.</li>
<li><strong>ExternalName</strong>: Maps the Service to the contents of the externalName field (e.g. foo.bar.example.com), by returning a CNAME record.</li>
</ul>
<p>An <a href="https://kubernetes.io/docs/concepts/services-networking/service/#externalname">ExternalName Service</a> is a special case of Service that does not have selectors and uses DNS names instead, e.g.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-database-svc</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ExternalName</span>
  <span class="nt">externalName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my.database.example.com</span>
</code></pre></div>
<p>In this example, when you request the service <code>my-database-svc.prod.svc.cluster.local</code> on the cluster, the cluster DNS Service returns a CNAME record for <code>my.database.example.com</code>.</p>
<p>You can also use <code>Ingress</code> in place of <code>Service</code> to expose HTTP/HTTPS Services. Ingress however is technically not a ServiceType, but it acts as the entry point for your cluster and lets you consolidate routing rules into a single resource.</p>
<h2 id="03-clusterip">03. ClusterIP<a class="headerlink" href="#03-clusterip" title="Permanent link">&para;</a></h2>
<h3 id="add-a-service-to-helloworld">Add a Service to <code>helloworld</code><a class="headerlink" href="#add-a-service-to-helloworld" title="Permanent link">&para;</a></h3>
<p>Now you have a simple understanding of the different ServiceTypes on Kubernetes, it is time to expose the Deployment of <code>helloworld</code> using a Service.</p>
<p>Create the Service object with the default type, you already created the Service resource file when you deployed the HelloWorld app in the previous step.</p>
<div class="highlight"><pre><span></span><code>$ kubectl create -f service.yaml
service/helloworld created
</code></pre></div>
<p>Describe the Service,</p>
<div class="highlight"><pre><span></span><code>$ kubectl describe svc helloworld
Name:              helloworld
Namespace:         default
Labels:            <span class="nv">app</span><span class="o">=</span>helloworld
Annotations:       &lt;none&gt;
Selector:          <span class="nv">app</span><span class="o">=</span>helloworld
Type:              ClusterIP
IP:                <span class="m">172</span>.21.161.255
Port:              &lt;unset&gt;  <span class="m">8080</span>/TCP
TargetPort:        http-server/TCP
Endpoints:         <span class="m">172</span>.30.153.79:8080
Session Affinity:  None
Events:            &lt;none&gt;
</code></pre></div>
<p>You see that Kubernetes by default creates a Service of type <code>ClusterIP</code>. The service is now available and discoverable, but only within the cluster.</p>
<p>Get the endpoints that were created as part of the Service,</p>
<div class="highlight"><pre><span></span><code>$ kubectl get endpoints helloworld
NAME         ENDPOINTS                                                  AGE
helloworld   <span class="m">172</span>.30.153.79:8080   43s
</code></pre></div>
<p>To review the full endpoints resource, use the <code>kubectl edit</code> command, but don't make any changes.</p>
<div class="highlight"><pre><span></span><code>$ kubectl edit endpoints helloworld

apiVersion: v1
kind: Endpoints
metadata:
  name: helloworld
  namespace: default
  labels:
    app: helloworld
subsets:
  - addresses:
      - ip: <span class="m">172</span>.30.153.79
        targetRef:
          kind: Pod
          name: helloworld-5f8b6b587b-lwvcs
</code></pre></div>
<p>Enter <code>&lt;ESC&gt;</code> + <code>:q</code> to exit the commandline vim editor.</p>
<p>The Endpoints object now maps the Service object to the Pod on an internal IP address, so that other pods can access the Service of our HelloWorld application.</p>
<h2 id="04-nodeport">04. NodePort<a class="headerlink" href="#04-nodeport" title="Permanent link">&para;</a></h2>
<p>The HelloWorld Service is accessible now but only within the cluster. To expose a Service onto an external IP address, you have to create a ServiceType other than ClusterIP. Apps inside the cluster can access a pod by using the in-cluster IP of the service or by sending a request to the name of the service. When you use the name of the service, <code>kube-proxy</code> looks up the name in the cluster DNS provider and routes the request to the in-cluster IP address of the service.</p>
<p>To allow external traffic into a kubernetes cluster, you need a <code>NodePort</code> ServiceType. If you set the <code>type</code> field of Service to <code>NodePort</code>, Kubernetes allocates a port in the range 30000-32767. Each node proxies the assigned NodePort (the same port number on every Node) into your Service.</p>
<p>Patch the existing Service for <code>helloworld</code> to <code>type: NodePort</code>,</p>
<div class="highlight"><pre><span></span><code>$ kubectl patch svc helloworld -p <span class="s1">&#39;{&quot;spec&quot;: {&quot;type&quot;: &quot;NodePort&quot;}}&#39;</span>
service/helloworld patched
</code></pre></div>
<p>Describe the Service again,</p>
<div class="highlight"><pre><span></span><code>$ kubectl describe svc helloworld

Name:                     helloworld
Namespace:                default
Labels:                   <span class="nv">app</span><span class="o">=</span>helloworld
Annotations:              &lt;none&gt;
Selector:                 <span class="nv">app</span><span class="o">=</span>helloworld
Type:                     NodePort
IP:                       <span class="m">172</span>.21.161.255
Port:                     &lt;unset&gt;  <span class="m">8080</span>/TCP
TargetPort:               http-server/TCP
NodePort:                 &lt;unset&gt;  <span class="m">31777</span>/TCP
Endpoints:                <span class="m">172</span>.30.153.79:8080
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   &lt;none&gt;
</code></pre></div>
<p>In this example, Kubernetes added a NodePort with port value 31777 in this example. For everyone, this is likely to be a different port in the range 30000-32767.</p>
<p>You can now connect to the service via the public IP address of any worker node in the cluster and traffic gets forwarded to the service, which uses service discovery and the selector of the Service to deliver the request to the assigned pod. With this piece in place we now have a complete pipeline for load balancing external client requests to all the nodes in the cluster.</p>
<p>You don't have sufficient permissions to retrieve the cluster's worker nodes' Public IPs for the account that the clusters were created on, via the cloud shell and the <code>ibmcloud</code> cli. But you can find the worker nodes of your cluster in the cluster detail page in the IBM Cloud UI. Find your cluster via <a href="https://cloud.ibm.com/kubernetes/clusters">https://cloud.ibm.com/kubernetes/clusters</a>. Select your cluster and go to <code>Worker Nodes</code>, look for the Public IP of one of the worker nodes.</p>
<p><img alt="Cluster worker nodes" src="../assets/images/ibmcloud-cluster-workernodes.png" /></p>
<p>If you do have sufficient permissions you can view the worker nodes of your cluster with the command,</p>
<div class="highlight"><pre><span></span><code>ibmcloud ks worker ls --cluster <span class="nv">$CLUSTERNAME</span>
</code></pre></div>
<p>Test the deployment, e.g. with the example values for PUBLICIP and NODEPORT, again be aware that the PUBLIC_IP and NODEPORT are different for each of you.</p>
<div class="highlight"><pre><span></span><code>$ <span class="nv">PUBLICIP</span><span class="o">=</span><span class="m">150</span>.238.93.100
$ <span class="nv">NODEPORT</span><span class="o">=</span><span class="m">31110</span>
$ curl <span class="s2">&quot;http://</span><span class="nv">$PUBLICIP</span><span class="s2">:</span><span class="nv">$NODEPORT</span><span class="s2">/api&quot;</span>
Welcome to Spring Boot App

$ curl <span class="s2">&quot;http://</span><span class="nv">$PUBLICIP</span><span class="s2">:</span><span class="nv">$NODEPORT</span><span class="s2">/api/hello?name=John&quot;</span>
<span class="o">{</span> <span class="s2">&quot;message&quot;</span> : <span class="s2">&quot;Hello John&quot;</span> <span class="o">}</span>

$ curl <span class="s2">&quot;http://</span><span class="nv">$PUBLICIP</span><span class="s2">:</span><span class="nv">$NODEPORT</span><span class="s2">/api/messages&quot;</span>
<span class="o">[{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5edda3befc271d2b0330b8a6&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;John&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello John&quot;</span><span class="o">}]</span>
</code></pre></div>
<p>The client connects to the load balancer via a public IP address on the worker node. The load balancer selects a node and connects to it. Kube-proxy receives this connection and forwards it to the service at the cluster IP. At this point the request matches the netfilter rules and gets redirected to the server pod.</p>
<h2 id="05-loadbalancer">05. Loadbalancer<a class="headerlink" href="#05-loadbalancer" title="Permanent link">&para;</a></h2>
<p>In the previous steps, you created a service for the <code>helloworld</code> application with a clusterIP and then added a NodePort to the Service. But you still want a load balancer of some kind in front of your application, whether your clients are internal or coming in over the public network. A load balancer acts as a reverse proxy and distributes network or application traffic across a number of servers.</p>
<p><img alt="Reverse Proxy" src="../assets/images/wiki_reverse_proxy.png" /></p>
<p>To use a load balancer as a reverse proxy for distributing client traffic to the nodes in a cluster, you need a public IP address for the service that the clients can connect to, and you need IP addresses on the nodes themselves to which the load balancer can forward the requests.</p>
<p>A service of type <code>LoadBalancer</code> has all the capabilities of a <code>NodePort</code> service but also the ability to build out a complete ingress path. A <code>LoadBalancer</code> also has some limitations: you cannot configure the load balancer to terminate https traffic, do virtual hosts or path-based routing, so you can’t use a single load balancer to proxy to multiple services. These limitations led to the addition of a separate kubernetes resource for configuring load balancers, called an <code>Ingress</code> (see next section).</p>
<p>On cloud providers that support external load balancers, setting the <code>type</code> field to <code>LoadBalancer</code> provisions a load balancer for your Service. The actual creation of the load balancer happens asynchronously with the Service, so you might have to wait until the load balancer has been created.</p>
<h3 id="load-balancer-on-iks">Load Balancer on IKS<a class="headerlink" href="#load-balancer-on-iks" title="Permanent link">&para;</a></h3>
<p>The LoadBalancer service type is implemented differently depending on your cluster's infrastructure provider. On IKS (IBM Kubernetes Service), a <code>classic cluster</code> implements a Network Load Balancer (NLB) 1.0 by default.</p>
<h3 id="load-balancing-methods">Load Balancing Methods<a class="headerlink" href="#load-balancing-methods" title="Permanent link">&para;</a></h3>
<p>Before we create the load balancer with <code>NLB v1.0 + subdomain</code> for the <code>helloworld</code> application, review the different Load Balancing Methods on IKS:</p>
<ul>
<li><code>NodePort</code> exposes the app via a port and public IP address on a worker node.</li>
<li><code>NLB v1.0 + subdomain</code> uses basic load balancing that exposes the app with an IP address or a subdomain.</li>
<li><code>NLB v2.0 + subdomain</code>, uses Direct Server Return (DSR) load balancing, which does not change the packets but the destination address, and exposes the app with an IP address or a subdomain, supports SSL termination. (Network load balancer (NLB) 2.0 is in beta.)</li>
<li><code>Istio + NLB subdomain</code> uses basic load balancing that exposes the app with a subdomain and uses Istio routing rules.</li>
<li><code>Ingress with public ALB</code> (Application Load Balancing) uses HTTPS load balancing that exposes the app with a subdomain and uses custom routing rules and SSL termination for multiple apps. You can customize the ALB routing rules with <a href="https://cloud.ibm.com/docs/containers?topic=containers-ingress_annotation">annotations</a> (See next section).</li>
<li><code>Custom Ingress + NLB subdomain</code> uses HTTPS load balancing with a custom Ingress that exposes the app with the IBM-provided ALB subdomain and uses custom routing rules.</li>
</ul>
<h3 id="create-a-network-load-balancer-v10">Create a Network Load Balancer v1.0<a class="headerlink" href="#create-a-network-load-balancer-v10" title="Permanent link">&para;</a></h3>
<p>In the previous lab, you already created a <code>NodePort</code> Service. Patch the service for <code>helloworld</code> and change the type to <code>LoadBalancer</code>.</p>
<div class="highlight"><pre><span></span><code>$ kubectl patch svc helloworld -p <span class="s1">&#39;{&quot;spec&quot;: {&quot;type&quot;: &quot;LoadBalancer&quot;}}&#39;</span>
service/helloworld patched
</code></pre></div>
<p>If your cluster has more than 1 worker node, a LoadBalancer will be created and an external IP address is assigned to access the service.</p>
<div class="highlight"><pre><span></span><code>$ kubectl get svc helloworld
NAME    TYPE    CLUSTER-IP    EXTERNAL-IP    PORT<span class="o">(</span>S<span class="o">)</span>    AGE
helloworld   LoadBalancer   <span class="m">172</span>.21.161.255   <span class="m">169</span>.48.67.163   <span class="m">8080</span>:31777/TCP   24m
</code></pre></div>
<p>The biggest difference you can see is the presence of an External IP address for the service now.</p>
<p>Or describe the <code>helloworld</code> Service,</p>
<div class="highlight"><pre><span></span><code>kubectl describe svc helloworld
</code></pre></div>
<p>A Service of type LoadBalancer was created, 1 of 4 available portable public IP addresses were assigned to the Service. When you create a standard cluster on IBM Cloud, IKS automatically provisions a portable public subnet and a portable private subnet.</p>
<p>Now to access the NLB for the Service of the <code>helloworld</code> from the internet, you can use the public IP address of the NLB and the assigned port of the service in the format <code>&lt;External_IP_Address&gt;:&lt;NodePort&gt;</code>. NodePorts are accessible on every public and private IP address of every worker node within the cluster.</p>
<p>Access the <code>helloworld</code> app in a browser or with Curl,</p>
<div class="highlight"><pre><span></span><code>$ <span class="nv">EXTERNALIP</span><span class="o">=</span><span class="m">169</span>.48.67.163
$ curl <span class="s2">&quot;http://</span><span class="nv">$EXTERNALIP</span><span class="s2">:</span><span class="nv">$NODEPORT</span><span class="s2">/api/hello?name=MeAgain&quot;</span>
<span class="o">{</span> <span class="s2">&quot;message&quot;</span> : <span class="s2">&quot;Hello MeAgain&quot;</span> <span class="o">}</span>

$ curl <span class="s2">&quot;http://</span><span class="nv">$EXTERNALIP</span><span class="s2">:</span><span class="nv">$NODEPORT</span><span class="s2">/api/messages&quot;</span>
<span class="o">[{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee6e6206e986548955388ee&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;John&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello John&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee6e72e6e986548955388ef&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;MeAgain&quot;</span>,<span class="s2">&quot;</span>
<span class="s2">message&quot;</span>:<span class="s2">&quot;Hello MeAgain&quot;</span><span class="o">}]</span>
</code></pre></div>
<h2 id="06-ingress">06. Ingress<a class="headerlink" href="#06-ingress" title="Permanent link">&para;</a></h2>
<p><code>Ingress</code> is technically not a Service, but a load balancer and router for container clusters. It is a Kubernetes API object that manages external access to the services in a cluster. You can use <code>Ingress</code> to expose multiple app services to a public or private network by using a unique public or private route. The Ingress API also supports TLS termination, virtual hosts, and path-based routing.</p>
<p>When you create a standard cluster, an Ingress subdomain is already registered by default for your cluster, see the previous step. The paths to your app services are appended to this public route of the default Ingress Subdomain.</p>
<p>In a standard cluster on IKS, the Ingress <code>Application Load Balancer (ALB)</code> implements the <code>NGINX</code> Ingress controller. NGINX is one of the more popular load balancers and reverse proxies.</p>
<p>To expose an app using Ingress, you must define an <code>Ingress</code> resource first. The Ingress resource is a Kubernetes resource that defines the rules for how to route incoming requests for apps.</p>
<p>One Ingress resource is required per namespace where you have apps that you want to expose.</p>
<h2 id="changes-to-helloworld-for-ingress">Changes to HelloWorld for Ingress<a class="headerlink" href="#changes-to-helloworld-for-ingress" title="Permanent link">&para;</a></h2>
<p>I want to access <code>HelloWorld</code> via the Ingress subdomain and a path rule via a path <code>/hello</code>.</p>
<p>You need the Ingress Subdomain and Ingress Secret of your cluster to configure your Ingress resource. Go to your cluster's Overview page to see the Ingress subdomain and secret.</p>
<p><img alt="Ingress Subdomain" src="../assets/images/ibmcloud-cluster-ingress-subdomain.png" /></p>
<p>The <code>Ingress Secret</code> will be the first part of the
<code>Ingress Subdomain</code> of your cluster. E.g. if the <code>Ingress Subdomain</code> is the following:</p>
<div class="highlight"><pre><span></span><code>remkohdev-iks116-294603-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud
</code></pre></div>
<p>Then the <code>Ingress Secret</code> will be,</p>
<div class="highlight"><pre><span></span><code>remkohdev-iks116-294603-2bef1f4b4097001da9502000c44fc2b2-0000
</code></pre></div>
<p>The <code>Ingress Subdomain</code> has a format like <code>clustername-&lt;hash&gt;.region.containers.appdomain.cloud</code>.</p>
<p>If you have account management permissions, you can use the <code>ibmcloud</code> command in the CLI to retrieve the Ingress Subdomain and Secret,</p>
<div class="highlight"><pre><span></span><code>$ ibmcloud ks nlb-dns ls --cluster <span class="nv">$CLUSTERNAME</span>
OK
Hostname    IP<span class="o">(</span>s<span class="o">)</span>    Health Monitor    SSL Cert Status    SSL Cert Secret Name    Secret Namespace
remkohdev-iks116-294603-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud    <span class="m">169</span>.48.67.162    None    created    remkohdev-iks116-294603-2bef1f4b4097001da9502000c44fc2b2-0000    default
</code></pre></div>
<p>Or,</p>
<div class="highlight"><pre><span></span><code>ibmcloud ks cluster get --show-resources -c <span class="nv">$CLUSTERNAME</span>
</code></pre></div>
<p>Once you have the Ingress Subdomain and the Ingress Secret, create an Ingress resource with the following command, using a <code>rewrite path</code> annotation.</p>
<p>In the file below, make sure to change the <code>hosts</code> and <code>host</code> to the <code>Ingress Subdomain</code> of your cluster, and change the <code>secretName</code> to the value <code>Ingress Secret</code> of your cluster.</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s1">&#39;apiVersion: extensions/v1beta1</span>
<span class="s1">kind: Ingress</span>
<span class="s1">metadata:</span>
<span class="s1">  name: helloworld-ingress</span>
<span class="s1">  annotations:</span>
<span class="s1">    ingress.bluemix.net/rewrite-path: serviceName=helloworld rewrite=/</span>
<span class="s1">spec:</span>
<span class="s1">  tls:</span>
<span class="s1">  - hosts:</span>
<span class="s1">    - &lt;Ingress Subdomain&gt;</span>
<span class="s1">    secretName: &lt;Ingress Secret&gt;</span>
<span class="s1">  rules:</span>
<span class="s1">  - host: &lt;Ingress Subdomain&gt;</span>
<span class="s1">    http:</span>
<span class="s1">      paths:</span>
<span class="s1">      - path: /hello</span>
<span class="s1">        backend:</span>
<span class="s1">          serviceName: helloworld</span>
<span class="s1">          servicePort: 8080&#39;</span> &gt; ingress.yaml
</code></pre></div>
<p>Make sure you changed the values for <code>hosts</code>, <code>secretName</code> and <code>host</code>, edit the <code>ingress.yaml</code> file to make the necessary changes,</p>
<div class="highlight"><pre><span></span><code>vi ingress.yaml
</code></pre></div>
<p>Then create the Ingress for helloworld,</p>
<div class="highlight"><pre><span></span><code>$ kubectl create -f ingress.yaml
ingress.extensions/helloworld-ingress created
</code></pre></div>
<p>The above resource will create a similar access path to helloworld as <code>https://remkohdev-iks116-2n-clu-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud/hello</code>.</p>
<p>You can further <a href="https://cloud.ibm.com/docs/containers?topic=containers-ingress_annotation">customize Ingres routing with annotations</a> to customize the ALB settings, TLS settings, request and response annocations, service limits, user authentication, or error actions etc..</p>
<p>Try to access the <code>helloworld</code> API and the proxy using the Ingress Subdomain with the path to the service,</p>
<div class="highlight"><pre><span></span><code>$ <span class="nv">HOST</span><span class="o">=</span>remkohdev-iks116-294603-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud

$ curl <span class="s2">&quot;http://</span><span class="nv">$HOST</span><span class="s2">/hello/api/hello?name=JaneDoe&quot;</span>
<span class="o">{</span> <span class="s2">&quot;message&quot;</span> : <span class="s2">&quot;Hello JaneDoe&quot;</span> <span class="o">}</span>

$ curl <span class="s2">&quot;http://</span><span class="nv">$HOST</span><span class="s2">/hello/api/messages&quot;</span>
<span class="o">[{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee27306040cd720fa7ba32d&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;John&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello John&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee274e7040cd720fa7ba32e&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;MeAgain&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello MeAgain&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee2f325040cd720fa7ba32f&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;JaneDoe&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello JaneDoe&quot;</span><span class="o">}]</span>
</code></pre></div>
<p>If you instead want to use subdomain paths instead of URI paths, you would add the subdomain prefix to the hosts attribute. We skip creating subdomain paths, but review the followig example.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">extensions/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">helloworld-ingress</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">tls</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">remkohdev-iks116-3x-clu-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud</span>
    <span class="nt">secretName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">remkohdev-iks116-3x-clu-2bef1f4b4097001da9502000c44fc2b2-0000</span>
  <span class="nt">rules</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="p p-Indicator">&gt;-</span>
        <span class="no">hello.remkohdev-iks116-2n-clu-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud</span>
      <span class="nt">http</span><span class="p">:</span>
        <span class="nt">paths</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">backend</span><span class="p">:</span>
              <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">helloworld</span>
              <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
    <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="p p-Indicator">&gt;-</span>
        <span class="no">helloproxy.remkohdev-iks116-2n-clu-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud</span>
      <span class="nt">http</span><span class="p">:</span>
        <span class="nt">paths</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">backend</span><span class="p">:</span>
              <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">helloworld-proxy</span>
              <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8080</span>
</code></pre></div>
<p>This Ingress resource will create an access path to app1 at <a href="https://hello.remkohdev-iks116-2n-clu-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud/">https://hello.remkohdev-iks116-2n-clu-2bef1f4b4097001da9502000c44fc2b2-0000.us-south.containers.appdomain.cloud/</a></p>
<h2 id="06-network-policy">06. Network Policy<a class="headerlink" href="#06-network-policy" title="Permanent link">&para;</a></h2>
<p>In this last section of the Kubernetes Networking lab, I want to create a Network Policy that only allows traffic coming from the HelloWorld application in the <code>default</code> namespace and not from another HelloWorld application in a <code>test</code> namespace.</p>
<p>So first, create a new instance of the HelloWorld application in a new namespace called <code>test</code>.</p>
<p>Create a new namespace <code>test</code>,</p>
<div class="highlight"><pre><span></span><code>kubectl create namespace <span class="nb">test</span>
</code></pre></div>
<p>Create a second deployment of HelloWorld in the <code>test</code> namespace connecting to the same MongoDB service in the <code>default</code> namespace. Create the Kubernetes deployment resource,</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s1">&#39;apiVersion: apps/v1</span>
<span class="s1">kind: Deployment</span>
<span class="s1">metadata:</span>
<span class="s1">  name: helloworld2</span>
<span class="s1">  namespace: test</span>
<span class="s1">  labels:</span>
<span class="s1">    app: helloworld2</span>
<span class="s1">spec:</span>
<span class="s1">  replicas: 1</span>
<span class="s1">  selector:</span>
<span class="s1">    matchLabels:</span>
<span class="s1">      app: helloworld2</span>
<span class="s1">  template:</span>
<span class="s1">    metadata:</span>
<span class="s1">      labels:</span>
<span class="s1">        app: helloworld2</span>
<span class="s1">    spec:</span>
<span class="s1">      containers:</span>
<span class="s1">      - name: helloworld2</span>
<span class="s1">        image: remkohdev/helloworld:lab1v1.0</span>
<span class="s1">        ports:</span>
<span class="s1">        - name: http-server</span>
<span class="s1">          containerPort: 8080&#39;</span> &gt; deployment2.yaml
</code></pre></div>
<p>Create the kubernetes Service resource in the <code>test</code> namespace,</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s1">&#39;apiVersion: v1</span>
<span class="s1">kind: Service</span>
<span class="s1">metadata:</span>
<span class="s1">  name: helloworld2</span>
<span class="s1">  namespace: test</span>
<span class="s1">  labels:</span>
<span class="s1">    app: helloworld2</span>
<span class="s1">spec:</span>
<span class="s1">  type: LoadBalancer</span>
<span class="s1">  ports:</span>
<span class="s1">  - port: 8080</span>
<span class="s1">    targetPort: http-server</span>
<span class="s1">  selector:</span>
<span class="s1">    app: helloworld2</span>
<span class="s1">&#39;</span> &gt; service2.yaml
</code></pre></div>
<p>Deploy the Kubernetes Deployment and Service resource for HellWorld2 in the <code>test</code> namespace using the shared MongoDB instance in the <code>default</code> namespace,</p>
<div class="highlight"><pre><span></span><code>kubectl create -f deployment2.yaml
kubectl create -f service2.yaml
</code></pre></div>
<p>Get the External IP and the NodePort for the new service,</p>
<div class="highlight"><pre><span></span><code>$ kubectl get svc helloworld2 -n <span class="nb">test</span>
NAME          TYPE           CLUSTER-IP      EXTERNAL-IP    PORT<span class="o">(</span>S<span class="o">)</span>          AGE
helloworld2   LoadBalancer   <span class="m">172</span>.21.176.80   <span class="m">169</span>.48.215.4   <span class="m">8080</span>:31429/TCP   34s
</code></pre></div>
<p>Test the connection to the MongoDB instance,</p>
<div class="highlight"><pre><span></span><code>$ <span class="nv">EXTERNALIP2</span><span class="o">=</span><span class="m">169</span>.48.215.4
$ <span class="nv">NODEPORT2</span><span class="o">=</span><span class="m">31429</span>

$ curl http://<span class="nv">$EXTERNALIP2</span>:<span class="nv">$NODEPORT2</span>/api/messages
<span class="o">[{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5edda3befc271d2b0330b8a6&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;john&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello john&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5edda81e9a848c335b5d1e40&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;john&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello john&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5eddac2e9a848c335b5d1e41&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;MeAgain&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello MeAgain&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5eddb2269a848c335b5d1e42&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;JaneDoe&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello JaneDoe&quot;</span><span class="o">}]</span>
</code></pre></div>
<p>Get a new message,</p>
<div class="highlight"><pre><span></span><code>$ curl http://<span class="nv">$EXTERNALIP2</span>:<span class="nv">$NODEPORT2</span>/api/hello?name<span class="o">=</span>Joe2
<span class="o">{</span> <span class="s2">&quot;message&quot;</span> : <span class="s2">&quot;Hello Joe2&quot;</span> <span class="o">}</span>
</code></pre></div>
<h3 id="network-policy">Network Policy<a class="headerlink" href="#network-policy" title="Permanent link">&para;</a></h3>
<p>A network policy is a specification of how pods are allowed to communicate with each other and other network endpoints. By default pods are allowed to communicate with all pods, they are <code>non-isolated</code>. But there are conditions where you want pods to reject traffic.</p>
<p>NetworkPolicy uses labels to select pods and define rules which specify what traffic is allowed. A <code>policyTypes</code> field in the NetworkPolicy specification includes either <code>Ingress</code>, <code>Egress</code>, or both. <code>Ingress</code> means <code>coming in</code>, and <code>egress</code> means <code>going out</code>. Each rule in ingress/egress allows traffic which matches both the from/to and ports sections.</p>
<p>There are four kinds of selectors that group pods in an ingress <code>from</code> section or egress <code>to</code> section:</p>
<ul>
<li>podSelector,</li>
<li>namespaceSelector,</li>
<li>podSelector and namespaceSelector,</li>
<li>ipBlock for IP CIDR ranges.</li>
</ul>
<p>By grouping pods by pod name, namespace, or IP, you can allow and reject incoming and outgoing traffic on a cluster. When you create a Kubernetes cluster on IBM Cloud, default network policies are set up to secure the public network interface of every worker node in the cluster.</p>
<p>Every IBM Cloud Kubernetes Service (IKS) cluster is set up with a network plug-in called <code>Calico</code>. You can use both Kubernetes and Calico to create network policies for a cluster.</p>
<p><a href="https://docs.projectcalico.org/introduction/">Project Calico</a> is an open source networking and network security project for containers, Kubernetes, OpenShift but also Istio among other. Some of the advantages are that it can enforce a policy at different layers, at the host networking layer or at the service mesh layer for instance; it uses Linux kernel's optimized forwarding and access control capabilities; Calico is interoperable between Kubernetes and non-Kubernetes, in public cloud, on-prem on VMs or bare metal servers; Calico supports the Kubernetes API as well as extended network policy capabilities; and of course at IBM we love Calico because we love open source! ;-)</p>
<p>When a Kubernetes network policy is applied, it is automatically converted into a Calico network policy so that Calico can apply it as an Iptables rule. Calico network policies are a superset of the Kubernetes network policies and are applied by using calicoctl commands. Calico enforces the policies.</p>
<p>Calico uses two policy resources: NetworkPolicy and GlobalNetworkPolicy resources. A network policy is a namespaced resource that applies to pods/containers/VMs in that namespace.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">projectcalico.org/v3</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
</code></pre></div>
<p>Calico global network policy is a non-namespaced resource and can be applied to any kind of endpoint (pods, VMs, host interfaces) independent of namespace.</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">projectcalico.org/v3</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GlobalNetworkPolicy</span>
</code></pre></div>
<p>To create Calico NetworkPolicy or GlobalNetworkPolicy resources, you must install the calicoctl CLI. That takes a little bit too much time for this lab, so no Calico labs will be included in this hands-on lab.</p>
<p>To block all traffic from and to the <code>test</code> namespace, create the following Network Policy,</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s1">&#39;kind: NetworkPolicy</span>
<span class="s1">apiVersion: networking.k8s.io/v1</span>
<span class="s1">metadata:</span>
<span class="s1">    name: test-deny</span>
<span class="s1">    namespace: test</span>
<span class="s1">spec:</span>
<span class="s1">  podSelector:</span>
<span class="s1">    matchLabels: {}</span>
<span class="s1">  policyTypes:</span>
<span class="s1">  - Ingress</span>
<span class="s1">  - Egress&#39;</span> &gt; deny-test-namespace.yaml
</code></pre></div>
<p>Then create the Kubernetes Network Policy,</p>
<div class="highlight"><pre><span></span><code>$ kubectl create -f deny-test-namespace.yaml
networkpolicy.networking.k8s.io/test-deny created
</code></pre></div>
<p>Remember that when a Kubernetes network policy is created, it is automatically converted into a Calico network policy.</p>
<p>Try to access the HelloWorld2 API in the test namespace, via the LoadBalancer Service details for External IP and NodePort,</p>
<div class="highlight"><pre><span></span><code>$ kubectl get svc helloworld2 -n <span class="nb">test</span>
$ curl http://<span class="nv">$EXTERNALIP2</span>:<span class="nv">$NODEPORT2</span>/api/messages
curl: <span class="o">(</span><span class="m">7</span><span class="o">)</span> Failed to connect to <span class="m">169</span>.48.67.164 port <span class="m">32401</span>: Connection timed out
</code></pre></div>
<p>The service in the <code>test</code> namespace fails because it tries to access the MongoDB instance in the <code>default</code> namespace, but that is not allowed.</p>
<p>Now, try to access the HelloWorld API in the default namespace, by using the <code>helloworld</code> service details in the <code>default</code> namespace.</p>
<div class="highlight"><pre><span></span><code>$ kubectl get svc helloworld
$ curl http://<span class="nv">$EXTERNALIP</span>:<span class="nv">$NODEPORT</span>/api/messages
<span class="o">[{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5edda3befc271d2b0330b8a6&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;john&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello john&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5edda81e9a848c335b5d1e40&quot;</span>,<span class="s2">&quot;</span>
<span class="s2">sender&quot;</span>:<span class="s2">&quot;john&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello john&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5eddac2e9a848c335b5d1e41&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;MeAgain&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello</span>
<span class="s2">MeAgain&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5eddb2269a848c335b5d1e42&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;JaneDoe&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello JaneDoe&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5edeee2a2e61</span>
<span class="s2">fc739ece0820&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;Joe2&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello Joe2&quot;</span><span class="o">}]</span>
</code></pre></div>
<p>Delete the <code>test-deny</code> Network Policy again,</p>
<div class="highlight"><pre><span></span><code>kubectl delete NetworkPolicy test-deny -n <span class="nb">test</span>
</code></pre></div>
<p>Now your traffic from helloworld2 to the default namespace is allowed again.</p>
<div class="highlight"><pre><span></span><code>$ curl http://<span class="nv">$EXTERNALIP2</span>:<span class="nv">$NODEPORT2</span>/api/messages
<span class="o">[{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee6e6206e986548955388ee&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;John&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello John&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee6e72e6e986548955388ef&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;MeAgain&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello MeAgain&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee6e9c56e986548955388f0&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;JaneDoe&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello JaneDoe&quot;</span><span class="o">}</span>,<span class="o">{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;5ee6eb4574416c3c675a01a2&quot;</span>,<span class="s2">&quot;sender&quot;</span>:<span class="s2">&quot;Joe2&quot;</span>,<span class="s2">&quot;message&quot;</span>:<span class="s2">&quot;Hello Joe2&quot;</span><span class="o">}]</span>
</code></pre></div>
<p>Or to explicitly allow all traffic again, create the following NetworkPolicy,</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="s1">&#39;apiVersion: networking.k8s.io/v1</span>
<span class="s1">kind: NetworkPolicy</span>
<span class="s1">metadata:</span>
<span class="s1">  name: allow-all-ingress</span>
<span class="s1">spec:</span>
<span class="s1">  podSelector: {}</span>
<span class="s1">  ingress:</span>
<span class="s1">  - {}</span>
<span class="s1">  policyTypes:</span>
<span class="s1">  - Ingress&#39;</span> &gt; allow-all.yaml
</code></pre></div>
<p>Create the new NetworkPolicy again,</p>
<div class="highlight"><pre><span></span><code>kubectl create -f allow-all.yaml
</code></pre></div>
<h2 id="delete-resources">Delete Resources<a class="headerlink" href="#delete-resources" title="Permanent link">&para;</a></h2>
<p>To delete <code>helloworld2</code> resources, delete the namespace <code>test</code>,</p>
<div class="highlight"><pre><span></span><code>kubectl delete namespace <span class="nb">test</span>
</code></pre></div>
<p>To delete the NetworkPolicy,</p>
<div class="highlight"><pre><span></span><code>kubectl delete networkpolicy test-deny
kubectl delete networkpolicy allow-all-ingress
</code></pre></div>
<p>To delete the Ingress resource,</p>
<div class="highlight"><pre><span></span><code>kubectl delete ingress helloworld-ingress
</code></pre></div>
<p>To clean up the created resources for the <code>helloworld</code> application run the following command,</p>
<div class="highlight"><pre><span></span><code>kubectl delete deploy helloworld
kubectl delete svc helloworld
</code></pre></div>
<p>Uninstall MongoDB</p>
<div class="highlight"><pre><span></span><code>helm uninstall mongodb
</code></pre></div>
<ol>
<li>Continue to <a href="../lab-02/">Lab 2</a> or go back to the <a href="../SUMMARY/">Summary</a>.</li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../lab-00/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Workshop Setup
              </div>
            </div>
          </a>
        
        
          <a href="../lab-02/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Lab 2. Adding Secure Storage
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 IBM Developer
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/ibm" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/ibmdeveloper" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/ibm/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/user/developerworks" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://dev.to/ibmdeveloper" target="_blank" rel="noopener" title="dev.to" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ['navigation.tabs'],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>